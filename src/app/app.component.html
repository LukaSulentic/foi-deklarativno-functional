<div class="container">
  <header class="header">
    <h1>FP Sensor Dashboard</h1>
    <p>Implementacija map/filter/reduce/pipe bez gotovih metoda</p>
  </header>

  <div class="controls">
    <button (click)="reset()" class="btn btn-secondary">Originalni Podaci</button>
    <div class="divider"></div>
    <button (click)="applyFilter()" class="btn btn-primary">1. Filter (Baterija &lt; 20%)</button>
    <button (click)="applyMap()" class="btn btn-warning">2. Map (Generiraj Alarme)</button>
    <button (click)="applyReduce()" class="btn btn-info">3. Reduce (Prosjek Temp)</button>
    <button (click)="applyPipe()" class="btn btn-danger">4. Pipe (Filter + Map)</button>
    <div class="divider"></div>
    <button (click)="applyImpossibleFilter()" class="btn btn-outline-dark">5. Test: Prazan Skup</button>
  </div>

  <div class="status-bar">
    <span class="label">Trenutna operacija:</span>
    <span class="value">{{ currentOperation }}</span>
  </div>

  <div class="content-grid">
    
    <div class="panel">
      <h3>Ulazni Tok (Source)</h3>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Tip</th>
              <th>Vrijednost</th>
              <th>Baterija</th>
              <th>Lokacija</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let s of sourceData">
              <td>{{s.id}}</td>
              <td>{{s.sensorType}}</td>
              <td>{{s.value}}</td>
              <td [style.color]="s.batteryLevel < 20 ? 'red' : 'green'">
                {{s.batteryLevel}}%
              </td>
              <td>{{s.location}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="panel result-panel">
      <h3>Rezultat Transformacije</h3>
      
      <div class="table-container" *ngIf="viewMode === 'table'">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Tip</th>
              <th>Vrijednost</th>
              <th>Baterija</th>
              <th>Lokacija</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let s of $any(displayData)">
              <td>{{s.id}}</td>
              <td>{{s.sensorType}}</td>
              <td>{{s.value}}</td>
              <td [style.color]="s.batteryLevel < 20 ? 'red' : 'green'">
                {{s.batteryLevel}}%
              </td>
              <td>{{s.location}}</td>
            </tr>
            <tr *ngIf="$any(displayData).length === 0">
              <td colspan="5" style="text-align:center">Nema rezultata.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="list-container" *ngIf="viewMode === 'list'">
        <ul>
          <li *ngFor="let item of $any(displayData)" class="alert-item">
            {{ item }}
          </li>
        </ul>
      </div>

      <div class="stat-container" *ngIf="viewMode === 'stat'">
        <div class="stat-card">
          <span class="stat-label">Prosječna Temperatura</span>
          <span class="stat-value">{{ displayData }} °C</span>
        </div>
      </div>

    </div>
  </div>
  <div class="code-panel" *ngIf="activeCodeSnippet">
    <h3>Implementacija korištene funkcije</h3>
    <pre><code>{{ activeCodeSnippet }}</code></pre>
  </div>
</div>